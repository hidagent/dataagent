---
name: code-review
description: ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œå¸®åŠ©å®¡æŸ¥ä»£ç è´¨é‡ã€å‘ç°æ½œåœ¨é—®é¢˜å¹¶æä¾›æ”¹è¿›å»ºè®®
category: code
tags: [code, review, quality, best-practices]
---

# ä»£ç å®¡æŸ¥æŠ€èƒ½

## æ¦‚è¿°

è¿™ä¸ªæŠ€èƒ½å¸®åŠ©ä½ è¿›è¡Œä¸“ä¸šçš„ä»£ç å®¡æŸ¥ï¼ŒåŒ…æ‹¬ï¼š
- ä»£ç è´¨é‡è¯„ä¼°
- æ½œåœ¨ bug æ£€æµ‹
- æ€§èƒ½é—®é¢˜è¯†åˆ«
- å®‰å…¨æ¼æ´æ‰«æ
- æœ€ä½³å®è·µå»ºè®®

## ä½¿ç”¨æ–¹æ³•

å½“ç”¨æˆ·è¯·æ±‚ä»£ç å®¡æŸ¥æ—¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š

### 1. ä»£ç è´¨é‡æ£€æŸ¥

æ£€æŸ¥ä»¥ä¸‹æ–¹é¢ï¼š
- ä»£ç å¯è¯»æ€§å’Œå‘½åè§„èŒƒ
- å‡½æ•°/æ–¹æ³•é•¿åº¦å’Œå¤æ‚åº¦
- é‡å¤ä»£ç ï¼ˆDRY åŸåˆ™ï¼‰
- æ³¨é‡Šå’Œæ–‡æ¡£å®Œæ•´æ€§

### 2. æ½œåœ¨é—®é¢˜æ£€æµ‹

å…³æ³¨ä»¥ä¸‹é—®é¢˜ï¼š
- ç©ºæŒ‡é’ˆ/æœªå®šä¹‰å¼•ç”¨
- èµ„æºæ³„æ¼ï¼ˆå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰
- è¾¹ç•Œæ¡ä»¶å¤„ç†
- å¼‚å¸¸å¤„ç†å®Œæ•´æ€§

### 3. å®‰å…¨æ€§æ£€æŸ¥

æ£€æŸ¥å¸¸è§å®‰å…¨é—®é¢˜ï¼š
- SQL æ³¨å…¥é£é™©
- XSS æ¼æ´
- æ•æ„Ÿä¿¡æ¯æ³„éœ²
- ä¸å®‰å…¨çš„ä¾èµ–

### 4. æ€§èƒ½ä¼˜åŒ–å»ºè®®

è¯†åˆ«æ€§èƒ½é—®é¢˜ï¼š
- ä¸å¿…è¦çš„å¾ªç¯æˆ–é€’å½’
- ä½æ•ˆçš„æ•°æ®ç»“æ„ä½¿ç”¨
- å¯ç¼“å­˜çš„è®¡ç®—
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

## è¾“å‡ºæ ¼å¼

å®¡æŸ¥ç»“æœåº”åŒ…å«ï¼š

```markdown
## ä»£ç å®¡æŸ¥æŠ¥å‘Š

### æ€»ä½“è¯„åˆ†: X/10

### å‘ç°çš„é—®é¢˜

#### ä¸¥é‡é—®é¢˜ ğŸ”´
- [é—®é¢˜æè¿°]
  - ä½ç½®: [æ–‡ä»¶:è¡Œå·]
  - å»ºè®®: [ä¿®å¤å»ºè®®]

#### è­¦å‘Š ğŸŸ¡
- [é—®é¢˜æè¿°]
  - ä½ç½®: [æ–‡ä»¶:è¡Œå·]
  - å»ºè®®: [æ”¹è¿›å»ºè®®]

#### å»ºè®® ğŸŸ¢
- [ä¼˜åŒ–å»ºè®®]

### ä¼˜ç‚¹
- [ä»£ç ä¸­åšå¾—å¥½çš„åœ°æ–¹]

### æ€»ç»“
[æ•´ä½“è¯„ä»·å’Œä¸»è¦æ”¹è¿›æ–¹å‘]
```

## ç¤ºä¾‹

ç”¨æˆ·: "è¯·å¸®æˆ‘å®¡æŸ¥è¿™æ®µ Python ä»£ç "

```python
def get_user(id):
    conn = sqlite3.connect('db.sqlite')
    cursor = conn.cursor()
    cursor.execute(f"SELECT * FROM users WHERE id = {id}")
    return cursor.fetchone()
```

å®¡æŸ¥ç»“æœ:

## ä»£ç å®¡æŸ¥æŠ¥å‘Š

### æ€»ä½“è¯„åˆ†: 4/10

### å‘ç°çš„é—®é¢˜

#### ä¸¥é‡é—®é¢˜ ğŸ”´
- SQL æ³¨å…¥æ¼æ´
  - ä½ç½®: ç¬¬4è¡Œ
  - å»ºè®®: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ `cursor.execute("SELECT * FROM users WHERE id = ?", (id,))`

- èµ„æºæ³„æ¼
  - ä½ç½®: æ•´ä¸ªå‡½æ•°
  - å»ºè®®: ä½¿ç”¨ `with` è¯­å¥æˆ–ç¡®ä¿å…³é—­è¿æ¥

#### è­¦å‘Š ğŸŸ¡
- å‡½æ•°å‘½åä¸å¤Ÿæ˜ç¡®
  - å»ºè®®: æ”¹ä¸º `get_user_by_id`

- ç¼ºå°‘ç±»å‹æ³¨è§£
  - å»ºè®®: æ·»åŠ  `def get_user_by_id(id: int) -> Optional[tuple]:`

### å»ºè®®ä¿®å¤åçš„ä»£ç 

```python
from typing import Optional
import sqlite3

def get_user_by_id(user_id: int) -> Optional[tuple]:
    """æ ¹æ® ID è·å–ç”¨æˆ·ä¿¡æ¯"""
    with sqlite3.connect('db.sqlite') as conn:
        cursor = conn.cursor()
        cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))
        return cursor.fetchone()
```
